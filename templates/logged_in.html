<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Outlook API</title>


</head>

<body>
  <h1>Outlook API Test</h1>

  <p>I now have a token!</p>

  <button onclick=getInfo()>Show my info</button>
  <p id="myInfo"></p>
  <button onclick=getEvents()>Show my events</button>
  <p id="myEvents"></p>

  <script>
    var token = "{{token}}"
    var headers = new Headers({
      'Authorization': 'Bearer ' + token,
      'Content-Type': 'application/json'
    })
    function getInfo() {
      var request = new Request('https://graph.microsoft.com/v1.0/me', {
            method: 'GET',
            headers: headers
          })
      fetch(request).then(function(response) {
        return response.json()
      }).then(function(response) {
        document.getElementById("myInfo").innerHTML = JSON.stringify(response)
      })
    }

    function getEvents() {
      var request = new Request('https://graph.microsoft.com/v1.0/me/events', {
            method: 'GET',
            headers: headers
          })
      fetch(request).then(function(response) {
        return response.json()
      }).then(function(response) {
        document.getElementById("myEvents").innerHTML = JSON.stringify(response)
      })
    }
  </script>

</body>
</html>
